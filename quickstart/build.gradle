import org.apache.tools.ant.filters.FixCrLfFilter
import org.apache.tools.ant.filters.ReplaceTokens

task processFiltered(type: Copy) {

    srcDir = file('filtered')

    inputs.file srcDir
    inputs.file file("../build.gradle")
    outputs.dir sourceSets.main.classesDir

    from srcDir
    into sourceSets.main.classesDir

    // Use some of the filters provided by Ant
    filter(FixCrLfFilter)
    filter(ReplaceTokens, tokens: [
            quickstartVersion: version,
            tapestryReleaseVersion: version,
            servletApiReleaseVersion: servletAPIVersion,
            testngReleaseVersion: testngVersion,
            easymockReleaseVersion: easymockVersion,
            year: new GregorianCalendar()[Calendar.YEAR].toString()
    ])
}

processResources.dependsOn processFiltered
